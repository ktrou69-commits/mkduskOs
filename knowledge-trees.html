<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ë–∏–±–ª–∏–æ—Ç–µ–∫–∞ –î—Ä–µ–≤ –ó–Ω–∞–Ω–∏–π</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="app">
        <!-- Login Screen -->
        <div class="login-overlay" id="loginOverlay">
            <div class="login-container">
                <div class="login-box">
                    <div class="login-header">
                        <div class="login-logo">
                            <div class="logo-icon">üåô</div>
                            <div class="logo-text">MK.Dusk OS</div>
                            <div class="logo-subtitle">Knowledge Management System</div>
                    <button class="btn btn-primary" id="createItemBtn">
                        <span class="icon">‚ûï</span>
                        <span id="createBtnText">–°–æ–∑–¥–∞—Ç—å –¥–µ—Ä–µ–≤–æ</span>
                    </button>
                    <button class="btn btn-secondary" id="importBtn">
                        <span class="icon">üì•</span>
                        –ò–º–ø–æ—Ä—Ç
                    </button>
                    <button class="btn btn-secondary" id="exportCurrentBtn">
                        <span class="icon">üì§</span>
                        <span id="exportBtnText">–≠–∫—Å–ø–æ—Ä—Ç –¥–µ—Ä–µ–≤—å–µ–≤</span>
                    </button>
                    <button class="btn btn-secondary" id="exportAllBtn">
                        <span class="icon">üì¶</span>
                        –†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è
                    </button>
                    <button class="btn btn-secondary" id="syncSettingsBtn">
                        <span class="icon">‚öôÔ∏è</span>
                        –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
                    </button>
                    <button class="btn btn-warning" id="debugDataBtn" style="background: orange; color: white;">
                        <span class="icon">üîç</span>
                        DEBUG
                    </button>
                    <button class="btn btn-danger" id="bulkDeleteBtn" style="display: none;">
                        <span class="icon">üóëÔ∏è</span>
                        <span id="bulkDeleteText">–£–¥–∞–ª–∏—Ç—å –≤—ã–±—Ä–∞–Ω–Ω—ã–µ</span>
                    </button>
                </div>
            </div>
        </header>

        <!-- Main Content -->
        <main class="main">
            <!-- Sidebar -->
            <aside class="sidebar">
                <div class="sidebar-header">
                    <h3>–ê—Ä—Ö–∏–≤</h3>
                    <div class="category-tabs">
                        <button class="category-tab active" data-category="trees">
                            <span class="tab-icon">üå≥</span>
                            <span class="tab-label">–î–µ—Ä–µ–≤—å—è –∑–Ω–∞–Ω–∏–π</span>
                        </button>
                        <button class="category-tab" data-category="notes">
                            <span class="tab-icon">üìù</span>
                            <span class="tab-label">–ó–∞–º–µ—Ç–∫–∏</span>
                        </button>
                    </div>
                    <div class="bulk-actions" id="bulkActions" style="display: none;">
                        <label class="bulk-select-all">
                            <input type="checkbox" id="selectAllCheckbox">
                            <span>–í—ã–±—Ä–∞—Ç—å –≤—Å–µ</span>
                        </label>
                    </div>
                    
                    <div class="search-box">
                        <input type="text" id="searchInput" placeholder="–ü–æ–∏—Å–∫..." class="search-input">
                        <span class="search-icon">üîç</span>
                    </div>
                </div>
                
                <div class="trees-list" id="treesList">
                    <!-- –°–ø–∏—Å–æ–∫ –¥–µ—Ä–µ–≤—å–µ–≤ –±—É–¥–µ—Ç –∑–∞–≥—Ä—É–∂–∞—Ç—å—Å—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
                </div>
                
                <div class="sidebar-footer">
                    <div class="stats">
                        <div class="stat-item">
                            <span class="stat-number" id="totalTrees">0</span>
                            <span class="stat-label">–¥–µ—Ä–µ–≤—å–µ–≤</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number" id="totalNodes">0</span>
                            <span class="stat-label">—É–∑–ª–æ–≤</span>
                        </div>
                    </div>
                    <button class="btn btn-secondary stats-chart-btn" id="showStatsChart">
                        <span class="icon">üìä</span>
                        <span>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</span>
                    </button>
                </div>
            </aside>

            <!-- Content Area -->
            <section class="content">
                <!-- Welcome Screen -->
                <div class="welcome-screen" id="welcomeScreen">
                    <div class="welcome-content">
                        <div class="welcome-icon">üå≥</div>
                        <h2>–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –ë–∏–±–ª–∏–æ—Ç–µ–∫—É –î—Ä–µ–≤ –ó–Ω–∞–Ω–∏–π</h2>
                        <p>–°–æ–∑–¥–∞–≤–∞–π—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–µ—Ä–µ–≤—å—è –∑–Ω–∞–Ω–∏–π –¥–ª—è –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –∏ –∏–¥–µ–π</p>
                        <button class="btn btn-primary btn-large" id="createFirstItemBtn">
                            <span id="createFirstBtnText">–°–æ–∑–¥–∞—Ç—å –ø–µ—Ä–≤–æ–µ –¥–µ—Ä–µ–≤–æ</span>
                        </button>
                        <button class="btn btn-secondary btn-large" id="createSampleBtn" style="margin-top: 1rem;">
                            <span id="createSampleBtnText">–°–æ–∑–¥–∞—Ç—å –ø—Ä–∏–º–µ—Ä –¥–µ—Ä–µ–≤–∞</span>
                        </button>
                    </div>
                </div>

                <!-- Tree Viewer -->
                <div class="tree-viewer" id="treeViewer" style="display: none;">
                    <div class="tree-header">
                        <div class="tree-title">
                            <h2 id="currentTreeTitle">–ù–∞–∑–≤–∞–Ω–∏–µ –¥–µ—Ä–µ–≤–∞</h2>
                            <div class="tree-actions">
                                <button class="btn btn-icon" id="editTreeBtn" title="–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å">
                                    <span class="icon">‚úèÔ∏è</span>
                                </button>
                                <button class="btn btn-icon" id="deleteTreeBtn" title="–£–¥–∞–ª–∏—Ç—å">
                                    <span class="icon">üóëÔ∏è</span>
                                </button>
                            </div>
                        </div>
                        <div class="tree-meta">
                            <span class="tree-date" id="currentTreeDate">–°–æ–∑–¥–∞–Ω–æ: --</span>
                            <span class="tree-nodes-count" id="currentTreeNodes">0 —É–∑–ª–æ–≤</span>
                        </div>
                    </div>

                    <div class="tree-content" id="treeContent">
                        <!-- –î–µ—Ä–µ–≤–æ –±—É–¥–µ—Ç –æ—Ç–æ–±—Ä–∞–∂–∞—Ç—å—Å—è –∑–¥–µ—Å—å -->
                    </div>
                </div>
            </section>
        </main>
    </div>

    <!-- Modals -->
    
    <!-- Create/Edit Tree Modal -->
    <div class="modal" id="treeModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="treeModalTitle">–°–æ–∑–¥–∞—Ç—å –¥–µ—Ä–µ–≤–æ</h3>
                <button class="btn btn-icon modal-close" id="closeTreeModal">
                    <span class="icon">‚úï</span>
                </button>
            </div>
            <div class="modal-body">
                <form id="treeForm">
                    <div class="form-group">
                        <label for="treeName">–ù–∞–∑–≤–∞–Ω–∏–µ –¥–µ—Ä–µ–≤–∞</label>
                        <input type="text" id="treeName" class="form-input" placeholder="–í–≤–µ–¥–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏–µ –¥–µ—Ä–µ–≤–∞" required>
                    </div>
                    <div class="form-group">
                        <label for="treeDescription">–û–ø–∏—Å–∞–Ω–∏–µ</label>
                        <textarea id="treeDescription" class="form-textarea" placeholder="–ö—Ä–∞—Ç–∫–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –¥–µ—Ä–µ–≤–∞ –∑–Ω–∞–Ω–∏–π" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="treeCategory">–ö–∞—Ç–µ–≥–æ—Ä–∏—è</label>
                        <select id="treeCategory" class="form-select">
                            <option value="business">–ë–∏–∑–Ω–µ—Å</option>
                            <option value="technology">–¢–µ—Ö–Ω–æ–ª–æ–≥–∏–∏</option>
                            <option value="science">–ù–∞—É–∫–∞</option>
                            <option value="education">–û–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ</option>
                            <option value="personal">–õ–∏—á–Ω–æ–µ —Ä–∞–∑–≤–∏—Ç–∏–µ</option>
                            <option value="other">–î—Ä—É–≥–æ–µ</option>
                        </select>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" id="cancelTreeBtn">–û—Ç–º–µ–Ω–∞</button>
                <button type="submit" form="treeForm" class="btn btn-primary" id="saveTreeBtn">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
            </div>
        </div>
    </div>


    <!-- Statistics Modal -->
    <div class="modal" id="statsModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –¥–∞–Ω–Ω—ã—Ö</h3>
                <button class="btn btn-icon modal-close" id="closeStatsModal">
                    <span class="icon">‚úï</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="stats-overview">
                    <div class="stats-summary">
                        <div class="summary-item">
                            <div class="summary-number" id="statsTreesCount">0</div>
                            <div class="summary-label">üå≥ –î–µ—Ä–µ–≤—å—è –∑–Ω–∞–Ω–∏–π</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number" id="statsNotesCount">0</div>
                            <div class="summary-label">üìù –ó–∞–º–µ—Ç–∫–∏</div>
                        </div>
                        <div class="summary-item">
                            <div class="summary-number" id="statsTotalCount">0</div>
                            <div class="summary-label">üìä –í—Å–µ–≥–æ —ç–ª–µ–º–µ–Ω—Ç–æ–≤</div>
                        </div>
                    </div>
                    
                    <div class="chart-container">
                        <canvas id="statsChart" width="300" height="300"></canvas>
                    </div>
                    
                    <div class="stats-details">
                        <h4>–î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞</h4>
                        <div class="details-grid">
                            <div class="detail-item">
                                <span class="detail-label">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –¥–µ—Ä–µ–≤—å–µ–≤:</span>
                                <span class="detail-value" id="treeCategoriesCount">0</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">–ö–∞—Ç–µ–≥–æ—Ä–∏–∏ –∑–∞–º–µ—Ç–æ–∫:</span>
                                <span class="detail-value" id="noteCategoriesCount">0</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">–°–æ–∑–¥–∞–Ω–æ —Å–µ–≥–æ–¥–Ω—è:</span>
                                <span class="detail-value" id="createdTodayCount">0</span>
                            </div>
                            <div class="detail-item">
                                <span class="detail-label">–°–æ–∑–¥–∞–Ω–æ –Ω–∞ —ç—Ç–æ–π –Ω–µ–¥–µ–ª–µ:</span>
                                <span class="detail-value" id="createdWeekCount">0</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary modal-close">–ó–∞–∫—Ä—ã—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- GitHub Sync Settings Modal -->
    <div class="modal" id="syncModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ GitHub</h3>
                <button class="btn btn-icon modal-close" id="closeSyncModal">
                    <span class="icon">‚úï</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="sync-settings">
                    <div class="form-group">
                        <label for="githubToken">GitHub Personal Access Token</label>
                        <input type="password" id="githubToken" class="form-input" placeholder="ghp_xxxxxxxxxxxxxxxxxxxx">
                        <small class="form-help">
                            <a href="https://github.com/settings/tokens" target="_blank">–°–æ–∑–¥–∞—Ç—å —Ç–æ–∫–µ–Ω</a> 
                            —Å –ø—Ä–∞–≤–∞–º–∏: repo (–¥–ª—è –ø—Ä–∏–≤–∞—Ç–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–≤) –∏–ª–∏ public_repo (–¥–ª—è –ø—É–±–ª–∏—á–Ω—ã—Ö)
                        </small>
                    </div>
                    
                    <div class="form-group">
                        <label for="githubRepo">–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π (username/repository)</label>
                        <input type="text" id="githubRepo" class="form-input" placeholder="myusername/knowledge-backup">
                        <small class="form-help">
                            –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –±—É–¥–µ—Ç —Å–æ–∑–¥–∞–Ω –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏, –µ—Å–ª–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç.<br>
                            <strong>–ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç:</strong> –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ –æ–¥–∏–Ω —Ñ–∞–π–ª backup.json
                        </small>
                    </div>
                    
                    <div class="form-group">
                        <label for="syncBranch">–í–µ—Ç–∫–∞</label>
                        <input type="text" id="syncBranch" class="form-input" value="main" placeholder="main">
                    </div>
                    
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="autoSync">
                            –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏—è—Ö
                        </label>
                    </div>
                    
                    <div class="sync-status" id="syncStatus">
                        <div class="status-item">
                            <span class="status-label">–°—Ç–∞—Ç—É—Å:</span>
                            <span class="status-value" id="connectionStatus">–ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ</span>
                        </div>
                        <div class="status-item">
                            <span class="status-label">–ü–æ—Å–ª–µ–¥–Ω—è—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è:</span>
                            <span class="status-value" id="lastSync">–ù–∏–∫–æ–≥–¥–∞</span>
                        </div>
                    </div>
                    
                    <div class="sync-actions">
                        <button class="btn btn-secondary" id="testConnection">
                            <span class="icon">üîç</span>
                            –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
                        </button>
                        <button class="btn btn-primary" id="syncNow">
                            <span class="icon">üì¶</span>
                            –°–æ–∑–¥–∞—Ç—å —Ä–µ–∑–µ—Ä–≤–Ω—É—é –∫–æ–ø–∏—é
                        </button>
                        <button class="btn btn-secondary" id="downloadFromGithub">
                            <span class="icon">üì•</span>
                            –ó–∞–≥—Ä—É–∑–∏—Ç—å —Å GitHub
                        </button>
                        <button class="btn btn-danger" id="clearRepository">
                            <span class="icon">üóëÔ∏è</span>
                            –û—á–∏—Å—Ç–∏—Ç—å —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π
                        </button>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary modal-close">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button type="button" class="btn btn-primary" id="saveSyncSettings">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</button>
            </div>
        </div>
    </div>

    <!-- Import Modal -->
    <div class="modal" id="importModal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>–ò–º–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö</h3>
                <button class="btn btn-icon modal-close" id="closeImportModal">
                    <span class="icon">‚úï</span>
                </button>
            </div>
            <div class="modal-body">
                <div class="import-info">
                    <p><strong>–ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ —Ñ–æ—Ä–º–∞—Ç—ã:</strong></p>
                    <ul>
                        <li>üì¶ <strong>–ü–æ–ª–Ω–∞—è —Ä–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è</strong> - –≤—Å–µ –¥–∞–Ω–Ω—ã–µ —Å –º–µ—Ç–∞–¥–∞–Ω–Ω—ã–º–∏</li>
                        <li>üì§ <strong>–ß–∞—Å—Ç–∏—á–Ω—ã–π —ç–∫—Å–ø–æ—Ä—Ç</strong> - —Ç–æ–ª—å–∫–æ –¥–µ—Ä–µ–≤—å—è –∏–ª–∏ –∑–∞–º–µ—Ç–∫–∏</li>
                        <li>üìÑ <strong>–°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç</strong> - —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å –ø—Ä–µ–¥—ã–¥—É—â–∏–º–∏ –≤–µ—Ä—Å–∏—è–º–∏</li>
                    </ul>
                </div>
                <div class="form-group">
                    <label for="importFile">–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∞–π–ª JSON</label>
                    <input type="file" id="importFile" class="form-input" accept=".json">
                </div>
                <div class="form-group">
                    <label for="importText">–ò–ª–∏ –≤—Å—Ç–∞–≤—å—Ç–µ JSON —Ç–µ–∫—Å—Ç</label>
                    <textarea id="importText" class="form-textarea" placeholder="–í—Å—Ç–∞–≤—å—Ç–µ JSON –¥–∞–Ω–Ω—ã–µ —Ä–µ–∑–µ—Ä–≤–Ω–æ–π –∫–æ–ø–∏–∏ –∏–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç–∞..." rows="8"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary modal-close">–ó–∞–∫—Ä—ã—Ç—å</button>
                <button type="button" class="btn btn-primary" id="executeImport">–ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞—Ç—å</button>
            </div>
        </div>
    </div>

    <!-- Notification -->
    <div class="notification" id="notification">
        <span class="notification-text"></span>
        <button class="notification-close">‚úï</button>
    </div>

    <script src="app.js"></script>
</body>
</html>
